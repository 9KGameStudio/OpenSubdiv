<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenSubdiv: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<strong syle="font-weight: bold; float: right">Pixar Animation Studios</strong>
<h1>OpenSubdiv</h1>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>opensubdiv/hbr/face.h</h1><a href="face_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">//     Copyright (C) Pixar. All rights reserved.</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">//     This license governs use of the accompanying software. If you</span>
<a name="l00005"></a>00005 <span class="comment">//     use the software, you accept this license. If you do not accept</span>
<a name="l00006"></a>00006 <span class="comment">//     the license, do not use the software.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">//     1. Definitions</span>
<a name="l00009"></a>00009 <span class="comment">//     The terms &quot;reproduce,&quot; &quot;reproduction,&quot; &quot;derivative works,&quot; and</span>
<a name="l00010"></a>00010 <span class="comment">//     &quot;distribution&quot; have the same meaning here as under U.S.</span>
<a name="l00011"></a>00011 <span class="comment">//     copyright law.  A &quot;contribution&quot; is the original software, or</span>
<a name="l00012"></a>00012 <span class="comment">//     any additions or changes to the software.</span>
<a name="l00013"></a>00013 <span class="comment">//     A &quot;contributor&quot; is any person or entity that distributes its</span>
<a name="l00014"></a>00014 <span class="comment">//     contribution under this license.</span>
<a name="l00015"></a>00015 <span class="comment">//     &quot;Licensed patents&quot; are a contributor&apos;s patent claims that read</span>
<a name="l00016"></a>00016 <span class="comment">//     directly on its contribution.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">//     2. Grant of Rights</span>
<a name="l00019"></a>00019 <span class="comment">//     (A) Copyright Grant- Subject to the terms of this license,</span>
<a name="l00020"></a>00020 <span class="comment">//     including the license conditions and limitations in section 3,</span>
<a name="l00021"></a>00021 <span class="comment">//     each contributor grants you a non-exclusive, worldwide,</span>
<a name="l00022"></a>00022 <span class="comment">//     royalty-free copyright license to reproduce its contribution,</span>
<a name="l00023"></a>00023 <span class="comment">//     prepare derivative works of its contribution, and distribute</span>
<a name="l00024"></a>00024 <span class="comment">//     its contribution or any derivative works that you create.</span>
<a name="l00025"></a>00025 <span class="comment">//     (B) Patent Grant- Subject to the terms of this license,</span>
<a name="l00026"></a>00026 <span class="comment">//     including the license conditions and limitations in section 3,</span>
<a name="l00027"></a>00027 <span class="comment">//     each contributor grants you a non-exclusive, worldwide,</span>
<a name="l00028"></a>00028 <span class="comment">//     royalty-free license under its licensed patents to make, have</span>
<a name="l00029"></a>00029 <span class="comment">//     made, use, sell, offer for sale, import, and/or otherwise</span>
<a name="l00030"></a>00030 <span class="comment">//     dispose of its contribution in the software or derivative works</span>
<a name="l00031"></a>00031 <span class="comment">//     of the contribution in the software.</span>
<a name="l00032"></a>00032 <span class="comment">//</span>
<a name="l00033"></a>00033 <span class="comment">//     3. Conditions and Limitations</span>
<a name="l00034"></a>00034 <span class="comment">//     (A) No Trademark License- This license does not grant you</span>
<a name="l00035"></a>00035 <span class="comment">//     rights to use any contributor&apos;s name, logo, or trademarks.</span>
<a name="l00036"></a>00036 <span class="comment">//     (B) If you bring a patent claim against any contributor over</span>
<a name="l00037"></a>00037 <span class="comment">//     patents that you claim are infringed by the software, your</span>
<a name="l00038"></a>00038 <span class="comment">//     patent license from such contributor to the software ends</span>
<a name="l00039"></a>00039 <span class="comment">//     automatically.</span>
<a name="l00040"></a>00040 <span class="comment">//     (C) If you distribute any portion of the software, you must</span>
<a name="l00041"></a>00041 <span class="comment">//     retain all copyright, patent, trademark, and attribution</span>
<a name="l00042"></a>00042 <span class="comment">//     notices that are present in the software.</span>
<a name="l00043"></a>00043 <span class="comment">//     (D) If you distribute any portion of the software in source</span>
<a name="l00044"></a>00044 <span class="comment">//     code form, you may do so only under this license by including a</span>
<a name="l00045"></a>00045 <span class="comment">//     complete copy of this license with your distribution. If you</span>
<a name="l00046"></a>00046 <span class="comment">//     distribute any portion of the software in compiled or object</span>
<a name="l00047"></a>00047 <span class="comment">//     code form, you may only do so under a license that complies</span>
<a name="l00048"></a>00048 <span class="comment">//     with this license.</span>
<a name="l00049"></a>00049 <span class="comment">//     (E) The software is licensed &quot;as-is.&quot; You bear the risk of</span>
<a name="l00050"></a>00050 <span class="comment">//     using it. The contributors give no express warranties,</span>
<a name="l00051"></a>00051 <span class="comment">//     guarantees or conditions. You may have additional consumer</span>
<a name="l00052"></a>00052 <span class="comment">//     rights under your local laws which this license cannot change.</span>
<a name="l00053"></a>00053 <span class="comment">//     To the extent permitted under your local laws, the contributors</span>
<a name="l00054"></a>00054 <span class="comment">//     exclude the implied warranties of merchantability, fitness for</span>
<a name="l00055"></a>00055 <span class="comment">//     a particular purpose and non-infringement.</span>
<a name="l00056"></a>00056 <span class="comment">//</span>
<a name="l00057"></a>00057 <span class="preprocessor">#ifndef HBRFACE_H</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span><span class="preprocessor">#define HBRFACE_H</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;cstdio&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;functional&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;../hbr/fvarData.h&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;../hbr/allocator.h&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#include &quot;libgprims/stitch.h&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;libgprims/stitchInternal.h&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#endif</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;../version.h&quot;</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keyword">namespace </span>OpenSubdiv {
<a name="l00077"></a>00077 <span class="keyword">namespace </span><a class="code" href="version_8h.html#a3e1fd5f7ca528466eeb21b73b1b33a8c">OPENSUBDIV_VERSION</a> {
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>HbrVertex;
<a name="l00080"></a>00080 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>HbrHalfedge;
<a name="l00081"></a>00081 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>HbrFace;
<a name="l00082"></a>00082 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>HbrMesh;
<a name="l00083"></a>00083 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>HbrHierarchicalEdit;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const HbrFace&lt;T&gt;&amp; face);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">// A descriptor for a path to a face</span>
<a name="l00088"></a><a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">00088</a> <span class="keyword">struct </span><a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a> {
<a name="l00089"></a><a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a91121815ad22cc823ab41c2621f6290f">00089</a>     <span class="keywordtype">void</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a91121815ad22cc823ab41c2621f6290f">Print</a>()<span class="keyword"> const </span>{
<a name="l00090"></a>00090         printf(<span class="stringliteral">&quot;%d&quot;</span>, <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a>);
<a name="l00091"></a>00091         <span class="keywordflow">for</span> (std::vector&lt;int&gt;::const_reverse_iterator i = <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.rbegin(); i != <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.rend(); ++i) {
<a name="l00092"></a>00092             printf(<span class="stringliteral">&quot; %d&quot;</span>, *i);
<a name="l00093"></a>00093         }
<a name="l00094"></a>00094         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">00097</a>     <span class="keywordtype">int</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a>;
<a name="l00098"></a>00098     <span class="comment">// Note that the elements in remainder are stored in reverse order.</span>
<a name="l00099"></a><a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">00099</a>     std::vector&lt;int&gt; <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>;
<a name="l00100"></a>00100     <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#af71b0b935b4eb44831a3ee36422a7b09">operator&lt; </a>(<span class="keyword">const</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a>&amp; x, <span class="keyword">const</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a>&amp; y);
<a name="l00101"></a>00101 };
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="namespaceOpenSubdiv_1_1OPENSUBDIV__VERSION.html#ae7393550c79dfeef99f58f03841ed02d">00103</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceOpenSubdiv_1_1OPENSUBDIV__VERSION.html#ae7393550c79dfeef99f58f03841ed02d">operator&lt; </a>(<span class="keyword">const</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a>&amp; x, <span class="keyword">const</span> <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a>&amp; y) {
<a name="l00104"></a>00104     <span class="keywordflow">if</span> (x.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a> != y.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a>) {
<a name="l00105"></a>00105         <span class="keywordflow">return</span> x.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a> &lt; y.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a>;
<a name="l00106"></a>00106     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.size() != y.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.size()) {
<a name="l00107"></a>00107         <span class="keywordflow">return</span> x.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.size() &lt; y.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.size();
<a name="l00108"></a>00108     } <span class="keywordflow">else</span> {
<a name="l00109"></a>00109         std::vector&lt;int&gt;::const_reverse_iterator i = x.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.rbegin();
<a name="l00110"></a>00110         std::vector&lt;int&gt;::const_reverse_iterator j = y.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.rbegin();
<a name="l00111"></a>00111         <span class="keywordflow">for</span> ( ; i != x.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.rend(); ++i, ++j) {
<a name="l00112"></a>00112             <span class="keywordflow">if</span> (*i != *j) <span class="keywordflow">return</span> (*i &lt; *j);
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">// A simple wrapper around an array of four children. Used to block</span>
<a name="l00119"></a>00119 <span class="comment">// allocate pointers to children of HbrFace in the common case</span>
<a name="l00120"></a>00120 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00121"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html">00121</a> <span class="keyword">class </span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html">HbrFaceChildren</a> {
<a name="l00122"></a>00122 <span class="keyword">public</span>:
<a name="l00123"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#a77f065ce52b3f2e8a31587a36dba4e71">00123</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a> *&amp; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#a77f065ce52b3f2e8a31587a36dba4e71">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> index) {
<a name="l00124"></a>00124         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#af9c57777b952a150e07045437309d190">children</a>[index];
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126 
<a name="l00127"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#a7497d80e281e6fb51d96da5ae66d7f6b">00127</a>     <span class="keyword">const</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a> *&amp; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#a7497d80e281e6fb51d96da5ae66d7f6b">operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l00128"></a>00128         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#af9c57777b952a150e07045437309d190">children</a>[index];
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130     
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="keyword">private</span>:
<a name="l00133"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#ac4de0b60423520fdb159ce960016732b">00133</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrAllocator.html">HbrAllocator</a>&lt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html">HbrFaceChildren</a>&lt;T&gt; &gt;;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="comment">// Used by block allocator</span>
<a name="l00136"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#a3c5b12b121ea5500011fba3b9adaadac">00136</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html">HbrFaceChildren&lt;T&gt;</a>*&amp; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#a3c5b12b121ea5500011fba3b9adaadac">GetNext</a>() { <span class="keywordflow">return</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html">HbrFaceChildren&lt;T&gt;</a>*&amp;) <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#af9c57777b952a150e07045437309d190">children</a>; }
<a name="l00137"></a>00137     
<a name="l00138"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#abac9096345180aca6e16c8aa986461b1">00138</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#abac9096345180aca6e16c8aa986461b1">HbrFaceChildren</a>() {}
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#ae58ba9c55e84f40649b6d9380d431220">00140</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#ae58ba9c55e84f40649b6d9380d431220">~HbrFaceChildren</a>() {}
<a name="l00141"></a>00141 
<a name="l00142"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#af9c57777b952a150e07045437309d190">00142</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a> *<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html#af9c57777b952a150e07045437309d190">children</a>[4];
<a name="l00143"></a>00143 };
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">00145</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace</a> {
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 <span class="keyword">private</span>:
<a name="l00148"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a78228f662af6e306a08ce8dbdc71c969">00148</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrAllocator.html">HbrAllocator</a>&lt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace</a>&lt;T&gt; &gt;;
<a name="l00149"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a2b48fc47dd4e53df3766388e6ee6f70e">00149</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge</a>&lt;T&gt;;
<a name="l00150"></a>00150     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae161edfde3500e7c2b3676e68d56ef0e">HbrFace</a>();
<a name="l00151"></a>00151     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d6cd20da78c834141b571a9f2a046f7">~HbrFace</a>();
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="keyword">public</span>:
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ab39590802c269dea030a2a5f77602e79">Initialize</a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrMesh.html">HbrMesh&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>, <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>, <span class="keywordtype">int</span> childindex, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a51f238ae2e6c9147fc81ffadcd7217af">uindex</a>, <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>, <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>** vertices, <span class="keywordtype">int</span> fvarwidth = 0, <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a69fcbe5675a0984e67537def5b548bf1">depth</a> = 0);
<a name="l00156"></a>00156     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae49db3bb5882db8accfcccc16d4075b1">Destroy</a>();
<a name="l00157"></a>00157 
<a name="l00158"></a>00158     <span class="comment">// Returns the mesh to which this face belongs</span>
<a name="l00159"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af4191ce5904dd344f316da2800716e3d">00159</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrMesh.html">HbrMesh&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af4191ce5904dd344f316da2800716e3d">GetMesh</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>; }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">// Return number of vertices</span>
<a name="l00162"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3244b4e26ce13909b14aabbf66965fa">00162</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3244b4e26ce13909b14aabbf66965fa">GetNumVertices</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>; }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="comment">// Return face ID</span>
<a name="l00165"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a5b28eb1766b86a09b374bb70fe8db543">00165</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a5b28eb1766b86a09b374bb70fe8db543">GetID</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af0491012ca821c7444a58a8620177721">id</a>; }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     <span class="comment">// Return the first halfedge of the face</span>
<a name="l00168"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7dcce0b6fec6997092f464255c07c94c">00168</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7dcce0b6fec6997092f464255c07c94c">GetFirstEdge</a>()<span class="keyword"> const </span>{
<a name="l00169"></a>00169         <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a> &gt; 4) {
<a name="l00170"></a>00170             <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a>[0]);
<a name="l00171"></a>00171         } <span class="keywordflow">else</span> {
<a name="l00172"></a>00172             <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0e87cceb25dce8c672daa1034facbe5e">edges</a>[0]);
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="comment">// Return the halfedge which originates at the vertex with the</span>
<a name="l00177"></a>00177     <span class="comment">// indicated origin index</span>
<a name="l00178"></a>00178     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(<span class="keywordtype">int</span> index) <span class="keyword">const</span>;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="comment">// Return the vertex with the indicated index</span>
<a name="l00181"></a>00181     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a559076922e8d22c27c11a506e34061b7">GetVertex</a>(<span class="keywordtype">int</span> index) <span class="keyword">const</span>;
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="comment">// Return the parent of this face</span>
<a name="l00184"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d66d2d37a686c62c203fd7694c61b20">00184</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d66d2d37a686c62c203fd7694c61b20">GetParent</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>; }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="comment">// Set the child</span>
<a name="l00187"></a>00187     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a14ffde955c192dcd544a01ca794b1ea6">SetChild</a>(<span class="keywordtype">int</span> index, <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* face);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <span class="comment">// Return the child with the indicated index</span>
<a name="l00190"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a01fee6408266c8cbcbe95d718a2107c7">00190</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a01fee6408266c8cbcbe95d718a2107c7">GetChild</a>(<span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l00191"></a>00191         <span class="keywordtype">int</span> nchildren = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;GetFaceChildrenCount(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>);
<a name="l00192"></a>00192         <span class="keywordflow">if</span> (!<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children || index &lt; 0 || index &gt;= nchildren) <span class="keywordflow">return</span> 0;
<a name="l00193"></a>00193         <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00194"></a>00194             <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[index];
<a name="l00195"></a>00195         } <span class="keywordflow">else</span> {
<a name="l00196"></a>00196             <span class="keywordflow">return</span> (*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[index];
<a name="l00197"></a>00197         }
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="comment">// Subdivide the face into a vertex if needed and return</span>
<a name="l00201"></a>00201     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a2b08b8de439ac5b37493c981cd899dd9">Subdivide</a>();
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <span class="comment">// Remove the reference to subdivided vertex</span>
<a name="l00204"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aad5286cdc0c1485cbec2fd17dd1b3e9e">00204</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aad5286cdc0c1485cbec2fd17dd1b3e9e">RemoveChild</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a> = 0; }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="comment">// &quot;Hole&quot; flags used by subdivision to drop faces</span>
<a name="l00207"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#adbdd41246115ffc7b66c1d99ce34dfb8">00207</a>     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#adbdd41246115ffc7b66c1d99ce34dfb8">IsHole</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae77262b77762c8aa0e0683ecd63b9a6c">hole</a>; }
<a name="l00208"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0658e2e3ad808b8a47fd5fe51d3a309b">00208</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0658e2e3ad808b8a47fd5fe51d3a309b">SetHole</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae77262b77762c8aa0e0683ecd63b9a6c">hole</a> = 1; }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     <span class="comment">// Coarse faces are the top level faces of a mesh. This will be</span>
<a name="l00211"></a>00211     <span class="comment">// set by mesh-&gt;Finish()</span>
<a name="l00212"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#afe2b3179b34b74b68bae69f9a31c2da0">00212</a>     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#afe2b3179b34b74b68bae69f9a31c2da0">IsCoarse</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a18570323b06da087214d57090d107482">coarse</a>; }
<a name="l00213"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a65f904bf1029c26be897d8de36672095">00213</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a65f904bf1029c26be897d8de36672095">SetCoarse</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a18570323b06da087214d57090d107482">coarse</a> = 1; }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="comment">// Protected faces cannot be garbage collected; this may be set on</span>
<a name="l00216"></a>00216     <span class="comment">// coarse level faces if the mesh is shared</span>
<a name="l00217"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad41977d97305911204ab2f1971a02ca2">00217</a>     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad41977d97305911204ab2f1971a02ca2">IsProtected</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">protect</a>; }
<a name="l00218"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aec81e077d7a0081dc32be5c2adc34018">00218</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aec81e077d7a0081dc32be5c2adc34018">SetProtected</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">protect</a> = 1; }
<a name="l00219"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af7100a9a1034bfab7f325095a2b28582">00219</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af7100a9a1034bfab7f325095a2b28582">ClearProtected</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">protect</a> = 0; }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <span class="comment">// Simple bookkeeping needed for garbage collection by HbrMesh</span>
<a name="l00222"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a3025d224e7656aee7c5e5b9d40759b73">00222</a>     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a3025d224e7656aee7c5e5b9d40759b73">IsCollected</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7fd0030eb13a9cb31e5b55a085fa0bf1">collected</a>; }
<a name="l00223"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a77e59805d9578cec514b795335256284">00223</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a77e59805d9578cec514b795335256284">SetCollected</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7fd0030eb13a9cb31e5b55a085fa0bf1">collected</a> = 1; }
<a name="l00224"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af8dd068f2910076640b68e990d00d3bf">00224</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af8dd068f2910076640b68e990d00d3bf">ClearCollected</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7fd0030eb13a9cb31e5b55a085fa0bf1">collected</a> = 0; }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="comment">// Refine the face</span>
<a name="l00227"></a>00227     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0082c511a521d30094b78402c9fb26b1">Refine</a>();
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="comment">// Unrefine the face</span>
<a name="l00230"></a>00230     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac998612933ce03a39fcae38a04cdc9b3">Unrefine</a>();
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <span class="comment">// Returns true if the face has a limit surface</span>
<a name="l00233"></a>00233     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a96394c9cbd232eb1edfe5b746d37fb3c">HasLimit</a>();
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <span class="comment">// Returns memory statistics</span>
<a name="l00236"></a>00236     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac9114738af18e3b73c03351fba419d72">GetMemStats</a>() <span class="keyword">const</span>;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="comment">// Return facevarying data from the appropriate vertex index</span>
<a name="l00239"></a>00239     <span class="comment">// registered to this face. Note that this may either be &quot;generic&quot;</span>
<a name="l00240"></a>00240     <span class="comment">// facevarying item (data.GetFace() == 0) or one specifically</span>
<a name="l00241"></a>00241     <span class="comment">// registered to the face (data.GetFace() == this) - this is</span>
<a name="l00242"></a>00242     <span class="comment">// important when trying to figure out whether the vertex has</span>
<a name="l00243"></a>00243     <span class="comment">// created some storage for the item designed to store</span>
<a name="l00244"></a>00244     <span class="comment">// discontinuous values for this face.</span>
<a name="l00245"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a397aa3799d2f23b2e0472e931228c59b">00245</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFVarData.html">HbrFVarData&lt;T&gt;</a>&amp; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a397aa3799d2f23b2e0472e931228c59b">GetFVarData</a>(<span class="keywordtype">int</span> index) {
<a name="l00246"></a>00246         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a559076922e8d22c27c11a506e34061b7">GetVertex</a>(index)-&gt;GetFVarData(<span class="keyword">this</span>);
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="comment">// Mark this face as being used, which in turn increments the</span>
<a name="l00250"></a>00250     <span class="comment">// usage counter of all vertices in the support for the face. A</span>
<a name="l00251"></a>00251     <span class="comment">// used face can not be garbage collected</span>
<a name="l00252"></a>00252     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a32803ce22742e3c46b72182beff8c6cc">MarkUsage</a>();
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="comment">// Clears the usage of this face, which in turn decrements the</span>
<a name="l00255"></a>00255     <span class="comment">// usage counter of all vertices in the support for the face and</span>
<a name="l00256"></a>00256     <span class="comment">// marks the face as a candidate for garbage collection</span>
<a name="l00257"></a>00257     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac9502286b77377e6664e7621fe9b4dbb">ClearUsage</a>();
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     <span class="comment">// A face can be cleaned if all of its vertices are not being</span>
<a name="l00260"></a>00260     <span class="comment">// used; has no children; and (for top level faces) deletion of</span>
<a name="l00261"></a>00261     <span class="comment">// its edges will not leave singular vertices</span>
<a name="l00262"></a>00262     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a50c9d38e11e0ccc24b5756e1f569f2f3">GarbageCollectable</a>() <span class="keyword">const</span>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <span class="comment">// Connect this face to a list of hierarchical edits</span>
<a name="l00265"></a>00265     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae4dddd0449dd335bdb8c5d3fb5d21f28">SetHierarchicalEdits</a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHierarchicalEdit.html">HbrHierarchicalEdit&lt;T&gt;</a>** <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a206d687376bd6a2a45f5f209ab1ee9ac">edits</a>);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <span class="comment">// Return the list of hierarchical edits associated with this face</span>
<a name="l00268"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a400bb8bcc2067ffa61f9c2672a047f07">00268</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHierarchicalEdit.html">HbrHierarchicalEdit&lt;T&gt;</a>** <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a400bb8bcc2067ffa61f9c2672a047f07">GetHierarchicalEdits</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a206d687376bd6a2a45f5f209ab1ee9ac">edits</a>; }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270     <span class="comment">// Whether the face has certain types of edits (not necessarily</span>
<a name="l00271"></a>00271     <span class="comment">// local - could apply to a subface)</span>
<a name="l00272"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a02391724bc5e3e4e952420a14fe106e0">00272</a>     <span class="keywordtype">bool</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a02391724bc5e3e4e952420a14fe106e0">HasVertexEdits</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a168b1e8ac0757330b8251dc208c9dc13">hasVertexEdits</a>; }
<a name="l00273"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a259dc3270e389a3c560ebdc4befd6f9e">00273</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a259dc3270e389a3c560ebdc4befd6f9e">MarkVertexEdits</a>() { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a168b1e8ac0757330b8251dc208c9dc13">hasVertexEdits</a> = 1; }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="comment">// Return the depth of the face</span>
<a name="l00276"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a92ab63f2d7b6076ca65f7ea78504ae06">00276</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a92ab63f2d7b6076ca65f7ea78504ae06">GetDepth</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a69fcbe5675a0984e67537def5b548bf1">depth</a>); }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <span class="comment">// Return the uniform index of the face. This is different</span>
<a name="l00279"></a>00279     <span class="comment">// from the ID because it may be shared with other faces</span>
<a name="l00280"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#abb6424aca802b727afe2e12afa803027">00280</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#abb6424aca802b727afe2e12afa803027">GetUniformIndex</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a51f238ae2e6c9147fc81ffadcd7217af">uindex</a>; }
<a name="l00281"></a>00281 
<a name="l00282"></a>00282     <span class="comment">// Set the uniform index of the face</span>
<a name="l00283"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af26636186c4d57ca4ec4fb6be5193d11">00283</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af26636186c4d57ca4ec4fb6be5193d11">SetUniformIndex</a>(<span class="keywordtype">int</span> i) { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a51f238ae2e6c9147fc81ffadcd7217af">uindex</a> = i; }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     <span class="comment">// Return the ptex index</span>
<a name="l00286"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a95375b7bdc49b12ed0224b3a2c7b12b9">00286</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a95375b7bdc49b12ed0224b3a2c7b12b9">GetPtexIndex</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a04b8e6984c373c4475d87651a4a8fa8b">ptexindex</a>; }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <span class="comment">// Set the ptex index of the face</span>
<a name="l00289"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a6a84bfbe5dae1adb1dfc7980e45d06e9">00289</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a6a84bfbe5dae1adb1dfc7980e45d06e9">SetPtexIndex</a>(<span class="keywordtype">int</span> i) { <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a04b8e6984c373c4475d87651a4a8fa8b">ptexindex</a> = i; }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <span class="comment">// Used by block allocator</span>
<a name="l00292"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8973b78cf3c04a4d451a5fdd7c1f2d01">00292</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>*&amp; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8973b78cf3c04a4d451a5fdd7c1f2d01">GetNext</a>() { <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>; }
<a name="l00293"></a>00293 
<a name="l00294"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a45e1dc32e8b537047d3b081027df91c2">00294</a>     <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a45e1dc32e8b537047d3b081027df91c2">GetPath</a>()<span class="keyword"> const </span>{
<a name="l00295"></a>00295         <a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html">HbrFacePath</a> path;
<a name="l00296"></a>00296         path.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.reserve(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a92ab63f2d7b6076ca65f7ea78504ae06">GetDepth</a>());
<a name="l00297"></a>00297         <span class="keyword">const</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* f = <span class="keyword">this</span>, *p = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d66d2d37a686c62c203fd7694c61b20">GetParent</a>();
<a name="l00298"></a>00298         <span class="keywordflow">while</span> (p) {
<a name="l00299"></a>00299             <span class="keywordtype">int</span> nchildren = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;GetFaceChildrenCount(p-&gt;nvertices);
<a name="l00300"></a>00300             <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00301"></a>00301                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nchildren; ++i) {
<a name="l00302"></a>00302                     <span class="keywordflow">if</span> (p-&gt;children.extrachildren[i] == f) {
<a name="l00303"></a>00303                         path.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.push_back(i);
<a name="l00304"></a>00304                         <span class="keywordflow">break</span>;
<a name="l00305"></a>00305                     }
<a name="l00306"></a>00306                 }
<a name="l00307"></a>00307             } <span class="keywordflow">else</span> {
<a name="l00308"></a>00308                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nchildren; ++i) {
<a name="l00309"></a>00309                     <span class="keywordflow">if</span> ((*p-&gt;children.children)[i] == f) {
<a name="l00310"></a>00310                         path.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.push_back(i);
<a name="l00311"></a>00311                         <span class="keywordflow">break</span>;
<a name="l00312"></a>00312                     }
<a name="l00313"></a>00313                 }
<a name="l00314"></a>00314             }
<a name="l00315"></a>00315             f = p;
<a name="l00316"></a>00316             p = f-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d66d2d37a686c62c203fd7694c61b20">GetParent</a>();
<a name="l00317"></a>00317         }
<a name="l00318"></a>00318         path.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#ab5a7c8993c5c0c83d3d91149aac335ba">topface</a> = f-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a5b28eb1766b86a09b374bb70fe8db543">GetID</a>();
<a name="l00319"></a>00319         assert(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a92ab63f2d7b6076ca65f7ea78504ae06">GetDepth</a>() == 0 || static_cast&lt;int&gt;(path.<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a8c12efd40e5aeb22a631b63769b72dcc">remainder</a>.size()) == <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a92ab63f2d7b6076ca65f7ea78504ae06">GetDepth</a>());
<a name="l00320"></a>00320         <span class="keywordflow">return</span> path;
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322 
<a name="l00323"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a25706405743358d0e584872b04180500">00323</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a25706405743358d0e584872b04180500">PrintPath</a>()<span class="keyword"> const </span>{
<a name="l00324"></a>00324         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a45e1dc32e8b537047d3b081027df91c2">GetPath</a>().<a class="code" href="structOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFacePath.html#a91121815ad22cc823ab41c2621f6290f">Print</a>();
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     <span class="comment">// Returns the blind pointer to client data</span>
<a name="l00328"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9403730158e2a10532e020bb0cf46ae8">00328</a>     <span class="keywordtype">void</span> *<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9403730158e2a10532e020bb0cf46ae8">GetClientData</a>()<span class="keyword"> const </span>{
<a name="l00329"></a>00329         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8bba16ed656fdccddc1f4520aaad5e07">clientData</a>;
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="comment">// Sets the blind pointer to client data</span>
<a name="l00333"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#add29db48440378eee39ff88de2f7b1b0">00333</a>     <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#add29db48440378eee39ff88de2f7b1b0">SetClientData</a>(<span class="keywordtype">void</span> *data) {
<a name="l00334"></a>00334         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8bba16ed656fdccddc1f4520aaad5e07">clientData</a> = data;
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="keyword">private</span>:
<a name="l00339"></a>00339 
<a name="l00340"></a>00340     <span class="comment">// Mesh to which this face belongs</span>
<a name="l00341"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">00341</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrMesh.html">HbrMesh&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     <span class="comment">// Unique id for this face</span>
<a name="l00344"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af0491012ca821c7444a58a8620177721">00344</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af0491012ca821c7444a58a8620177721">id</a>;
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     <span class="comment">// Uniform index</span>
<a name="l00347"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a51f238ae2e6c9147fc81ffadcd7217af">00347</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a51f238ae2e6c9147fc81ffadcd7217af">uindex</a>;
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <span class="comment">// Ptex index</span>
<a name="l00350"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a04b8e6984c373c4475d87651a4a8fa8b">00350</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a04b8e6984c373c4475d87651a4a8fa8b">ptexindex</a>;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352     <span class="comment">// Number of vertices (and number of edges)</span>
<a name="l00353"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">00353</a>     <span class="keywordtype">int</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>;
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     <span class="comment">// Halfedge array for this face</span>
<a name="l00356"></a>00356     <span class="comment">// HbrHalfedge::getIndex() relies on this being size 4</span>
<a name="l00357"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0e87cceb25dce8c672daa1034facbe5e">00357</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0e87cceb25dce8c672daa1034facbe5e">edges</a>[4];
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     <span class="comment">// Edge storage if this face is not a triangle or quad</span>
<a name="l00360"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">00360</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a>;
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     <span class="comment">// Pointer to parent face</span>
<a name="l00363"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">00363</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <span class="comment">// Pointer to children array. If there are four children or less,</span>
<a name="l00366"></a>00366     <span class="comment">// we use the HbrFaceChildren pointer, otherwise we use</span>
<a name="l00367"></a>00367     <span class="comment">// extrachildren</span>
<a name="l00368"></a>00368     <span class="keyword">union </span>{
<a name="l00369"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">00369</a>         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceChildren.html">HbrFaceChildren&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>;
<a name="l00370"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a90bf23a3aaf7a2bf9ec75e93a2d703bb">00370</a>         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>** <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a90bf23a3aaf7a2bf9ec75e93a2d703bb">extrachildren</a>;
<a name="l00371"></a>00371     } <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>;
<a name="l00372"></a>00372 
<a name="l00373"></a>00373     <span class="comment">// Subdivided vertex child</span>
<a name="l00374"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">00374</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>;
<a name="l00375"></a>00375 
<a name="l00376"></a>00376     <span class="comment">// Bits used by halfedges to track facevarying sharpnesses</span>
<a name="l00377"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">00377</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a>;
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00380"></a>00380 <span class="preprocessor"></span>    <span class="comment">// Pointers to stitch edges and data used by the half edges.</span>
<a name="l00381"></a>00381     StitchEdge **stitchEdges;
<a name="l00382"></a>00382     <span class="keywordtype">void</span> **stitchDatas;
<a name="l00383"></a>00383 <span class="preprocessor">#endif</span>
<a name="l00384"></a>00384 <span class="preprocessor"></span>
<a name="l00385"></a>00385     <span class="comment">// Pointer to a list of hierarchical edits applicable to this face</span>
<a name="l00386"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a206d687376bd6a2a45f5f209ab1ee9ac">00386</a>     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHierarchicalEdit.html">HbrHierarchicalEdit&lt;T&gt;</a>** <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a206d687376bd6a2a45f5f209ab1ee9ac">edits</a>;
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <span class="comment">// Blind client data pointer</span>
<a name="l00389"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8bba16ed656fdccddc1f4520aaad5e07">00389</a>     <span class="keywordtype">void</span> * <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8bba16ed656fdccddc1f4520aaad5e07">clientData</a>;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="comment">// Depth of the face in the mesh hierarchy - coarse faces are</span>
<a name="l00392"></a>00392     <span class="comment">// level 0. (Hmmm.. is it safe to assume that we&apos;ll never</span>
<a name="l00393"></a>00393     <span class="comment">// subdivide to greater than 255?)</span>
<a name="l00394"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a69fcbe5675a0984e67537def5b548bf1">00394</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a69fcbe5675a0984e67537def5b548bf1">depth</a>;
<a name="l00395"></a>00395 
<a name="l00396"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae77262b77762c8aa0e0683ecd63b9a6c">00396</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae77262b77762c8aa0e0683ecd63b9a6c">hole</a>:1;
<a name="l00397"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a18570323b06da087214d57090d107482">00397</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a18570323b06da087214d57090d107482">coarse</a>:1;
<a name="l00398"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">00398</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">protect</a>:1;
<a name="l00399"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7fd0030eb13a9cb31e5b55a085fa0bf1">00399</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7fd0030eb13a9cb31e5b55a085fa0bf1">collected</a>:1;
<a name="l00400"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a168b1e8ac0757330b8251dc208c9dc13">00400</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a168b1e8ac0757330b8251dc208c9dc13">hasVertexEdits</a>:1;
<a name="l00401"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a906a846748ab0d7fd56728be88bdfea0">00401</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a906a846748ab0d7fd56728be88bdfea0">initialized</a>:1;
<a name="l00402"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a98a016039b93adbe962b0a08777c1f82">00402</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a98a016039b93adbe962b0a08777c1f82">destroyed</a>:1;
<a name="l00403"></a>00403 };
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 } <span class="comment">// end namespace OPENSUBDIV_VERSION</span>
<a name="l00406"></a>00406 <span class="keyword">using namespace </span><a class="code" href="version_8h.html#a3e1fd5f7ca528466eeb21b73b1b33a8c">OPENSUBDIV_VERSION</a>;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 } <span class="comment">// end namespace OpenSubdiv</span>
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 <span class="preprocessor">#include &quot;../hbr/mesh.h&quot;</span>
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="keyword">namespace </span>OpenSubdiv {
<a name="l00413"></a>00413 <span class="keyword">namespace </span><a class="code" href="version_8h.html#a3e1fd5f7ca528466eeb21b73b1b33a8c">OPENSUBDIV_VERSION</a> {
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00416"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae161edfde3500e7c2b3676e68d56ef0e">00416</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae161edfde3500e7c2b3676e68d56ef0e">HbrFace&lt;T&gt;::HbrFace</a>()
<a name="l00417"></a>00417     : mesh(0), id(-1), uindex(-1), ptexindex(-1), nvertices(0), extraedges(0), parent(0), vchild(0), fvarbits(0),
<a name="l00418"></a>00418 #ifdef HBRSTITCH
<a name="l00419"></a>00419       stitchEdges(0),
<a name="l00420"></a>00420       stitchDatas(0),
<a name="l00421"></a>00421 #endif
<a name="l00422"></a>00422       edits(0), clientData(0), depth(0), hole(0), coarse(0), protect(0), collected(0), hasVertexEdits(0), initialized(0), destroyed(0) {
<a name="l00423"></a>00423     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children = 0;
<a name="l00424"></a>00424 }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00427"></a>00427 <span class="keywordtype">void</span>
<a name="l00428"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ab39590802c269dea030a2a5f77602e79">00428</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ab39590802c269dea030a2a5f77602e79">HbrFace&lt;T&gt;::Initialize</a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrMesh.html">HbrMesh&lt;T&gt;</a>* m, <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* _parent, <span class="keywordtype">int</span> childindex, <span class="keywordtype">int</span> fid, <span class="keywordtype">int</span> _uindex, <span class="keywordtype">int</span> nv, <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>** vertices, <span class="keywordtype">int</span> <span class="comment">/* fvarwidth */</span>, <span class="keywordtype">int</span> _depth) {
<a name="l00429"></a>00429     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a> = m;
<a name="l00430"></a>00430     <span class="keywordtype">id</span> = fid;
<a name="l00431"></a>00431     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a51f238ae2e6c9147fc81ffadcd7217af">uindex</a> = _uindex;
<a name="l00432"></a>00432     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a04b8e6984c373c4475d87651a4a8fa8b">ptexindex</a> = -1;
<a name="l00433"></a>00433     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a> = nv;
<a name="l00434"></a>00434     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a> = 0;
<a name="l00435"></a>00435     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children = 0;
<a name="l00436"></a>00436     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a> = 0;
<a name="l00437"></a>00437     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a> = 0;
<a name="l00438"></a>00438 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span>    stitchEdges = 0;
<a name="l00440"></a>00440     stitchDatas = 0;
<a name="l00441"></a>00441 <span class="preprocessor">#endif</span>
<a name="l00442"></a>00442 <span class="preprocessor"></span>    <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a8bba16ed656fdccddc1f4520aaad5e07">clientData</a> = 0;
<a name="l00443"></a>00443     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a206d687376bd6a2a45f5f209ab1ee9ac">edits</a> = 0;
<a name="l00444"></a>00444     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a69fcbe5675a0984e67537def5b548bf1">depth</a> = _depth;
<a name="l00445"></a>00445     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae77262b77762c8aa0e0683ecd63b9a6c">hole</a> = 0;
<a name="l00446"></a>00446     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a18570323b06da087214d57090d107482">coarse</a> = 0;
<a name="l00447"></a>00447     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">protect</a> = 0;
<a name="l00448"></a>00448     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7fd0030eb13a9cb31e5b55a085fa0bf1">collected</a> = 0;
<a name="l00449"></a>00449     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a168b1e8ac0757330b8251dc208c9dc13">hasVertexEdits</a> = 0;
<a name="l00450"></a>00450     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a906a846748ab0d7fd56728be88bdfea0">initialized</a> = 1;
<a name="l00451"></a>00451     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a98a016039b93adbe962b0a08777c1f82">destroyed</a> = 0;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keywordtype">int</span> i;
<a name="l00454"></a>00454     <span class="keyword">const</span> <span class="keywordtype">int</span> fvarcount = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetFVarCount();
<a name="l00455"></a>00455     <span class="keywordtype">int</span> fvarbitsSizePerEdge = ((fvarcount + 15) / 16);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457     <span class="keywordflow">if</span> (nv &gt; 4) {
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="comment">// If we have more than four vertices, we ignore the</span>
<a name="l00460"></a>00460         <span class="comment">// overallocation and allocate our own buffers for stitch</span>
<a name="l00461"></a>00461         <span class="comment">// edges and facevarying data.</span>
<a name="l00462"></a>00462 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount()) {
<a name="l00464"></a>00464             stitchEdges = <span class="keyword">new</span> StitchEdge*[<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount() * nv];
<a name="l00465"></a>00465             stitchDatas = <span class="keyword">new</span> <span class="keywordtype">void</span>*[nv];
<a name="l00466"></a>00466             <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount() * nv; ++i) {
<a name="l00467"></a>00467                 stitchEdges[i] = 0;
<a name="l00468"></a>00468             }
<a name="l00469"></a>00469             <span class="keywordflow">for</span> (i = 0; i &lt; nv; ++i) {
<a name="l00470"></a>00470                 stitchDatas[i] = 0;
<a name="l00471"></a>00471             }
<a name="l00472"></a>00472         }
<a name="l00473"></a>00473 <span class="preprocessor">#endif</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (fvarcount) {
<a name="l00475"></a>00475             <span class="comment">// We allocate fvarbits in one chunk.</span>
<a name="l00476"></a>00476             <span class="comment">// fvarbits needs capacity for two bits per fvardatum per edge,</span>
<a name="l00477"></a>00477             <span class="comment">// minimum size one integer per edge</span>
<a name="l00478"></a>00478             <span class="keyword">const</span> <span class="keywordtype">size_t</span> fvarbitsSize = nv * (fvarbitsSizePerEdge * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int));
<a name="l00479"></a>00479             <span class="keywordtype">char</span> *buffer = (<span class="keywordtype">char</span>*) malloc(fvarbitsSize);
<a name="l00480"></a>00480             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*) buffer;
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         <span class="comment">// We also ignore the edge array and allocate extra storage -</span>
<a name="l00484"></a>00484         <span class="comment">// this simplifies GetNext and GetPrev math in HbrHalfedge</span>
<a name="l00485"></a>00485         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a> = <span class="keyword">new</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>[nv];
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     } <span class="keywordflow">else</span> {
<a name="l00488"></a>00488         <span class="comment">// Under four vertices: upstream allocation for the class has</span>
<a name="l00489"></a>00489         <span class="comment">// been over allocated to include storage for stitchEdges</span>
<a name="l00490"></a>00490         <span class="comment">// and fvarbits. Just point our pointers at it.</span>
<a name="l00491"></a>00491         <span class="keywordtype">char</span> *buffer = ((<span class="keywordtype">char</span> *) <span class="keyword">this</span> + <span class="keyword">sizeof</span>(*<span class="keyword">this</span>));
<a name="l00492"></a>00492 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00493"></a>00493 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount()) {
<a name="l00494"></a>00494             stitchEdges = (StitchEdge**) buffer;
<a name="l00495"></a>00495             buffer += 4 * <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount() * <span class="keyword">sizeof</span>(StitchEdge*);
<a name="l00496"></a>00496             stitchDatas = (<span class="keywordtype">void</span>**) buffer;
<a name="l00497"></a>00497             <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount() * 4; ++i) {
<a name="l00498"></a>00498                 stitchEdges[i] = 0;
<a name="l00499"></a>00499             }
<a name="l00500"></a>00500             <span class="keywordflow">for</span> (i = 0; i &lt; 4; ++i) {
<a name="l00501"></a>00501                 stitchDatas[i] = 0;
<a name="l00502"></a>00502             }
<a name="l00503"></a>00503             buffer += 4 * <span class="keyword">sizeof</span>(<span class="keywordtype">void</span>*);
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505 <span class="preprocessor">#endif</span>
<a name="l00506"></a>00506 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (fvarcount) {
<a name="l00507"></a>00507             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*) buffer;
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     <span class="comment">// Must do this before we create edges</span>
<a name="l00512"></a>00512     <span class="keywordflow">if</span> (_parent) {
<a name="l00513"></a>00513         _parent-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a14ffde955c192dcd544a01ca794b1ea6">SetChild</a>(childindex, <span class="keyword">this</span>);
<a name="l00514"></a>00514     }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516     <span class="comment">// Edges must be constructed in this two part approach: we must</span>
<a name="l00517"></a>00517     <span class="comment">// ensure that opposite/next/previous ptrs are all set up</span>
<a name="l00518"></a>00518     <span class="comment">// correctly, before we can begin adding incident edges to</span>
<a name="l00519"></a>00519     <span class="comment">// vertices.</span>
<a name="l00520"></a>00520     <span class="keywordtype">int</span> next;
<a name="l00521"></a>00521     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *curfvarbits = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a>;
<a name="l00522"></a>00522     <span class="keywordflow">for</span> (i = 0, next = 1; i &lt; nv; ++i, ++next) {
<a name="l00523"></a>00523         <span class="keywordflow">if</span> (next == nv) next = 0;
<a name="l00524"></a>00524         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* opposite = vertices[next]-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#ab41df701002e9db49952da0f393fcbd3">GetEdge</a>(vertices[i]);
<a name="l00525"></a>00525         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(i)-&gt;Initialize(opposite, i, vertices[i], curfvarbits, <span class="keyword">this</span>);
<a name="l00526"></a>00526         <span class="keywordflow">if</span> (opposite) opposite-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#aa07be383f06499b202ae12d9d6ecf095">SetOpposite</a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(i));
<a name="l00527"></a>00527         <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a>) {
<a name="l00528"></a>00528             curfvarbits = curfvarbits + fvarbitsSizePerEdge;
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531     <span class="keywordflow">for</span> (i = 0; i &lt; nv; ++i) {
<a name="l00532"></a>00532         vertices[i]-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#ab6f3530628df0496af5a2ead6adb74c6">AddIncidentEdge</a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(i));
<a name="l00533"></a>00533     }
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00537"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d6cd20da78c834141b571a9f2a046f7">00537</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d6cd20da78c834141b571a9f2a046f7">HbrFace&lt;T&gt;::~HbrFace</a>() {
<a name="l00538"></a>00538     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae49db3bb5882db8accfcccc16d4075b1">Destroy</a>();
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00542"></a>00542 <span class="keywordtype">void</span>
<a name="l00543"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae49db3bb5882db8accfcccc16d4075b1">00543</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae49db3bb5882db8accfcccc16d4075b1">HbrFace&lt;T&gt;::Destroy</a>() {
<a name="l00544"></a>00544     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a906a846748ab0d7fd56728be88bdfea0">initialized</a> &amp;&amp; !<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a98a016039b93adbe962b0a08777c1f82">destroyed</a>) {
<a name="l00545"></a>00545         <span class="keywordtype">int</span> i;
<a name="l00546"></a>00546 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00547"></a>00547 <span class="preprocessor"></span>        <span class="keyword">const</span> <span class="keywordtype">int</span> stitchCount = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetStitchCount();
<a name="l00548"></a>00548 <span class="preprocessor">#endif</span>
<a name="l00549"></a>00549 <span class="preprocessor"></span>
<a name="l00550"></a>00550         <span class="comment">// Remove children&apos;s references to self</span>
<a name="l00551"></a>00551         <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children) {
<a name="l00552"></a>00552             <span class="keywordtype">int</span> nchildren = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;GetFaceChildrenCount(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>);
<a name="l00553"></a>00553             <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00554"></a>00554                 <span class="keywordflow">for</span> (i = 0; i &lt; nchildren; ++i) {
<a name="l00555"></a>00555                     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[i]) {
<a name="l00556"></a>00556                         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[i]-&gt;parent = 0;
<a name="l00557"></a>00557                         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[i] = 0;
<a name="l00558"></a>00558                     }
<a name="l00559"></a>00559                 }
<a name="l00560"></a>00560                 <span class="keyword">delete</span>[] <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren;
<a name="l00561"></a>00561                 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren = 0;
<a name="l00562"></a>00562             } <span class="keywordflow">else</span> {
<a name="l00563"></a>00563                 <span class="keywordflow">for</span> (i = 0; i &lt; nchildren; ++i) {
<a name="l00564"></a>00564                     <span class="keywordflow">if</span> ((*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[i]) {
<a name="l00565"></a>00565                         (*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[i]-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a> = 0;
<a name="l00566"></a>00566                         (*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[i] = 0;
<a name="l00567"></a>00567                     }
<a name="l00568"></a>00568                 }
<a name="l00569"></a>00569                 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFaceChildren(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children);
<a name="l00570"></a>00570                 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children = 0;
<a name="l00571"></a>00571             }
<a name="l00572"></a>00572         }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574         <span class="comment">// Deleting the incident edges from the vertices in this way is</span>
<a name="l00575"></a>00575         <span class="comment">// the safest way of doing things. Doing it in the halfedge</span>
<a name="l00576"></a>00576         <span class="comment">// destructor will not work well because it disrupts cycle</span>
<a name="l00577"></a>00577         <span class="comment">// finding/incident edge replacement in the vertex code.</span>
<a name="l00578"></a>00578         <span class="comment">// We also take this time to clean up any orphaned stitches</span>
<a name="l00579"></a>00579         <span class="comment">// still belonging to the edges.</span>
<a name="l00580"></a>00580         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>; ++i) {
<a name="l00581"></a>00581             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a> *edge = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(i);
<a name="l00582"></a>00582 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00583"></a>00583 <span class="preprocessor"></span>            edge-&gt;DestroyStitchEdges(stitchCount);
<a name="l00584"></a>00584 <span class="preprocessor">#endif</span>
<a name="l00585"></a>00585 <span class="preprocessor"></span>            <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* vertex = edge-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ac78adb75925d2e2cc89260ac72cb177e">GetOrgVertex</a>();
<a name="l00586"></a>00586             <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a>) {
<a name="l00587"></a>00587                 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFVarData.html">HbrFVarData&lt;T&gt;</a>&amp; fvt = vertex-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#ae2b9eeea373112055d7bc5cb4d150703">GetFVarData</a>(<span class="keyword">this</span>);
<a name="l00588"></a>00588                 <span class="keywordflow">if</span> (fvt.<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFVarData.html#a9a6364150ece6eabc523cdd88bcf58a7">GetFace</a>() == <span class="keyword">this</span>) {
<a name="l00589"></a>00589                     fvt.<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFVarData.html#a0dfc80d6cf0680d2e5616f11a4a80a95">SetFace</a>(0);
<a name="l00590"></a>00590                 }
<a name="l00591"></a>00591             }
<a name="l00592"></a>00592             vertex-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a01d07b473a3979778b8c1a63f634047d">RemoveIncidentEdge</a>(edge);
<a name="l00593"></a>00593             vertex-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a264079917ba6b7c88cacf7ae21ad19a2">UnGuaranteeNeighbors</a>();
<a name="l00594"></a>00594         }
<a name="l00595"></a>00595         <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a>) {
<a name="l00596"></a>00596             <span class="keyword">delete</span>[] <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a>;
<a name="l00597"></a>00597             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a> = 0;
<a name="l00598"></a>00598         }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600         <span class="comment">// Remove parent&apos;s reference to self</span>
<a name="l00601"></a>00601         <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>) {
<a name="l00602"></a>00602             <span class="keywordtype">bool</span> parentHasOtherKids = <span class="keyword">false</span>;
<a name="l00603"></a>00603             <span class="keywordtype">int</span> nchildren = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;GetFaceChildrenCount(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;nvertices);
<a name="l00604"></a>00604             <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00605"></a>00605                 <span class="keywordflow">for</span> (i = 0; i &lt; nchildren; ++i) {
<a name="l00606"></a>00606                     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.extrachildren[i] == <span class="keyword">this</span>) {
<a name="l00607"></a>00607                         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.extrachildren[i] = 0;
<a name="l00608"></a>00608                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.extrachildren[i]) parentHasOtherKids = <span class="keyword">true</span>;
<a name="l00609"></a>00609                 }
<a name="l00610"></a>00610                 <span class="comment">// After cleaning the parent&apos;s reference to self, the parent</span>
<a name="l00611"></a>00611                 <span class="comment">// may be able to clean itself up</span>
<a name="l00612"></a>00612                 <span class="keywordflow">if</span> (!parentHasOtherKids) {
<a name="l00613"></a>00613                     <span class="keyword">delete</span>[] <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.extrachildren;
<a name="l00614"></a>00614                     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.extrachildren = 0;
<a name="l00615"></a>00615                     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;GarbageCollectable()) {
<a name="l00616"></a>00616                         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFace(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>);
<a name="l00617"></a>00617                     }
<a name="l00618"></a>00618                 }
<a name="l00619"></a>00619             } <span class="keywordflow">else</span> {
<a name="l00620"></a>00620                 <span class="keywordflow">for</span> (i = 0; i &lt; nchildren; ++i) {
<a name="l00621"></a>00621                     <span class="keywordflow">if</span> ((*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.children)[i] == <span class="keyword">this</span>) {
<a name="l00622"></a>00622                         (*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.children)[i] = 0;
<a name="l00623"></a>00623                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.children)[i]) parentHasOtherKids = <span class="keyword">true</span>;
<a name="l00624"></a>00624                 }
<a name="l00625"></a>00625                 <span class="comment">// After cleaning the parent&apos;s reference to self, the parent</span>
<a name="l00626"></a>00626                 <span class="comment">// may be able to clean itself up</span>
<a name="l00627"></a>00627                 <span class="keywordflow">if</span> (!parentHasOtherKids) {
<a name="l00628"></a>00628                     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFaceChildren(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.children);
<a name="l00629"></a>00629                     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;children.children = 0;
<a name="l00630"></a>00630                     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>-&gt;GarbageCollectable()) {
<a name="l00631"></a>00631                         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFace(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a>);
<a name="l00632"></a>00632                     }
<a name="l00633"></a>00633                 }
<a name="l00634"></a>00634             }
<a name="l00635"></a>00635             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a> = 0;
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638         <span class="comment">// Orphan the child vertex</span>
<a name="l00639"></a>00639         <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>) {
<a name="l00640"></a>00640             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>-&gt;SetParent(static_cast&lt;HbrFace*&gt;(0));
<a name="l00641"></a>00641             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a> = 0;
<a name="l00642"></a>00642         }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644         <span class="keywordflow">if</span> (nvertices &gt; 4 &amp;&amp; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a>) {
<a name="l00645"></a>00645             free(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a>);
<a name="l00646"></a>00646 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00647"></a>00647 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (stitchEdges) {
<a name="l00648"></a>00648                 <span class="keyword">delete</span>[] stitchEdges;
<a name="l00649"></a>00649             }
<a name="l00650"></a>00650             <span class="keywordflow">if</span> (stitchDatas) {
<a name="l00651"></a>00651                 <span class="keyword">delete</span>[] stitchDatas;
<a name="l00652"></a>00652             }
<a name="l00653"></a>00653 <span class="preprocessor">#endif</span>
<a name="l00654"></a>00654 <span class="preprocessor"></span>        }
<a name="l00655"></a>00655         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aea91587fc534bff21b68654ea1846d2e">fvarbits</a> = 0;
<a name="l00656"></a>00656 <span class="preprocessor">#ifdef HBRSTITCH</span>
<a name="l00657"></a>00657 <span class="preprocessor"></span>        stitchEdges = 0;
<a name="l00658"></a>00658         stitchDatas = 0;
<a name="l00659"></a>00659 <span class="preprocessor">#endif</span>
<a name="l00660"></a>00660 <span class="preprocessor"></span>
<a name="l00661"></a>00661         <span class="comment">// Make sure the four edges intrinsic to face are properly cleared</span>
<a name="l00662"></a>00662         <span class="comment">// if they were used</span>
<a name="l00663"></a>00663         <span class="keywordflow">if</span> (nvertices &lt;= 4) {
<a name="l00664"></a>00664             <span class="keywordflow">for</span> (i = 0; i &lt; nvertices; ++i) {
<a name="l00665"></a>00665                 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(i)-&gt;Clear();
<a name="l00666"></a>00666             }
<a name="l00667"></a>00667         }
<a name="l00668"></a>00668         nvertices = 0;
<a name="l00669"></a>00669         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a906a846748ab0d7fd56728be88bdfea0">initialized</a> = 0;
<a name="l00670"></a>00670         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a98a016039b93adbe962b0a08777c1f82">destroyed</a> = 1;
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672 }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00675"></a>00675 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>*
<a name="l00676"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">00676</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">HbrFace&lt;T&gt;::GetEdge</a>(<span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l00677"></a>00677     assert(index &gt;= 0 &amp;&amp; index &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>);
<a name="l00678"></a>00678     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a> &gt; 4) {
<a name="l00679"></a>00679         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a> + index;
<a name="l00680"></a>00680     } <span class="keywordflow">else</span> {
<a name="l00681"></a>00681         <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>*<span class="keyword">&gt;</span>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0e87cceb25dce8c672daa1034facbe5e">edges</a> + index);
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00686"></a>00686 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>*
<a name="l00687"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a559076922e8d22c27c11a506e34061b7">00687</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a559076922e8d22c27c11a506e34061b7">HbrFace&lt;T&gt;::GetVertex</a>(<span class="keywordtype">int</span> index)<span class="keyword"> const </span>{
<a name="l00688"></a>00688     assert(index &gt;= 0 &amp;&amp; index &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>);
<a name="l00689"></a>00689     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a> &gt; 4) {
<a name="l00690"></a>00690         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a647430695be2e23bdb4bc67b716b0aa0">extraedges</a>[index].GetOrgVertex();
<a name="l00691"></a>00691     } <span class="keywordflow">else</span> {
<a name="l00692"></a>00692         <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0e87cceb25dce8c672daa1034facbe5e">edges</a>[index].GetOrgVertex();
<a name="l00693"></a>00693     }
<a name="l00694"></a>00694 }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00697"></a>00697 <span class="keywordtype">void</span>
<a name="l00698"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a14ffde955c192dcd544a01ca794b1ea6">00698</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a14ffde955c192dcd544a01ca794b1ea6">HbrFace&lt;T&gt;::SetChild</a>(<span class="keywordtype">int</span> index, <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* face) {
<a name="l00699"></a>00699     <span class="keywordtype">int</span> nchildren = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;GetFaceChildrenCount(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>);
<a name="l00700"></a>00700     <span class="comment">// Construct the children array if it doesn&apos;t already exist</span>
<a name="l00701"></a>00701     <span class="keywordflow">if</span> (!<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children) {
<a name="l00702"></a>00702         <span class="keywordtype">int</span> i;
<a name="l00703"></a>00703         <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00704"></a>00704             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren = <span class="keyword">new</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>*[nchildren];
<a name="l00705"></a>00705             <span class="keywordflow">for</span> (i = 0; i &lt; nchildren; ++i) {
<a name="l00706"></a>00706                 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[i] = 0;
<a name="l00707"></a>00707             }
<a name="l00708"></a>00708         } <span class="keywordflow">else</span> {
<a name="l00709"></a>00709             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;NewFaceChildren();
<a name="l00710"></a>00710             <span class="keywordflow">for</span> (i = 0; i &lt; nchildren; ++i) {
<a name="l00711"></a>00711                 (*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[i] = 0;
<a name="l00712"></a>00712             }
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714     }
<a name="l00715"></a>00715     <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00716"></a>00716         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[index] = face;
<a name="l00717"></a>00717     } <span class="keywordflow">else</span> {
<a name="l00718"></a>00718         (*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[index] = face;
<a name="l00719"></a>00719     }
<a name="l00720"></a>00720     face-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#af40433bcaa8f7afb99c337e7bedff628">parent</a> = <span class="keyword">this</span>;
<a name="l00721"></a>00721 }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00724"></a>00724 <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>*
<a name="l00725"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a2b08b8de439ac5b37493c981cd899dd9">00725</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a2b08b8de439ac5b37493c981cd899dd9">HbrFace&lt;T&gt;::Subdivide</a>() {
<a name="l00726"></a>00726     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>) <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>;
<a name="l00727"></a>00727     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a> = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;Subdivide(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>, <span class="keyword">this</span>);
<a name="l00728"></a>00728     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>-&gt;SetParent(<span class="keyword">this</span>);
<a name="l00729"></a>00729     <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3b6e5d1bde813c1e6951c46e6e76fc6">vchild</a>;
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00733"></a>00733 <span class="keywordtype">void</span>
<a name="l00734"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0082c511a521d30094b78402c9fb26b1">00734</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a0082c511a521d30094b78402c9fb26b1">HbrFace&lt;T&gt;::Refine</a>() {
<a name="l00735"></a>00735     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;Refine(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>, <span class="keyword">this</span>);
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00739"></a>00739 <span class="keywordtype">void</span>
<a name="l00740"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac998612933ce03a39fcae38a04cdc9b3">00740</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac998612933ce03a39fcae38a04cdc9b3">HbrFace&lt;T&gt;::Unrefine</a>() {
<a name="l00741"></a>00741     <span class="comment">// Delete the children, via the mesh (so that the mesh loses</span>
<a name="l00742"></a>00742     <span class="comment">// references to the children)</span>
<a name="l00743"></a>00743     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children) {
<a name="l00744"></a>00744         <span class="keywordtype">int</span> nchildren = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;GetFaceChildrenCount(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>);
<a name="l00745"></a>00745         <span class="keywordflow">if</span> (nchildren &gt; 4) {
<a name="l00746"></a>00746             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nchildren; ++i) {
<a name="l00747"></a>00747                 <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[i]) <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFace(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren[i]);
<a name="l00748"></a>00748             }
<a name="l00749"></a>00749             <span class="keyword">delete</span>[] <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren;
<a name="l00750"></a>00750             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.extrachildren = 0;
<a name="l00751"></a>00751         } <span class="keywordflow">else</span> {
<a name="l00752"></a>00752             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nchildren; ++i) {
<a name="l00753"></a>00753                 <span class="keywordflow">if</span> ((*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[i]) <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFace((*<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children)[i]);
<a name="l00754"></a>00754             }
<a name="l00755"></a>00755             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;DeleteFaceChildren(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children);
<a name="l00756"></a>00756             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children = 0;
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759 }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00762"></a>00762 <span class="keywordtype">bool</span>
<a name="l00763"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a96394c9cbd232eb1edfe5b746d37fb3c">00763</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a96394c9cbd232eb1edfe5b746d37fb3c">HbrFace&lt;T&gt;::HasLimit</a>() {
<a name="l00764"></a>00764     <span class="keywordflow">return</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GetSubdivision()-&gt;HasLimit(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>, <span class="keyword">this</span>);
<a name="l00765"></a>00765 }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00768"></a>00768 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>
<a name="l00769"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac9114738af18e3b73c03351fba419d72">00769</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac9114738af18e3b73c03351fba419d72">HbrFace&lt;T&gt;::GetMemStats</a>()<span class="keyword"> const </span>{
<a name="l00770"></a>00770     <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>);
<a name="l00771"></a>00771 }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00774"></a>00774 <span class="keywordtype">void</span>
<a name="l00775"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a32803ce22742e3c46b72182beff8c6cc">00775</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a32803ce22742e3c46b72182beff8c6cc">HbrFace&lt;T&gt;::MarkUsage</a>() {
<a name="l00776"></a>00776     <span class="comment">// Must increment the usage on all vertices which are in the</span>
<a name="l00777"></a>00777     <span class="comment">// support for this face</span>
<a name="l00778"></a>00778     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* v;
<a name="l00779"></a>00779     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* e = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7dcce0b6fec6997092f464255c07c94c">GetFirstEdge</a>(), *ee, *eee, *start;
<a name="l00780"></a>00780     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>; ++i) {
<a name="l00781"></a>00781         v = e-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ac78adb75925d2e2cc89260ac72cb177e">GetOrgVertex</a>();
<a name="l00782"></a>00782         v-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a3eb19d571d6b403d62770f19781016c1">GuaranteeNeighbors</a>();
<a name="l00783"></a>00783         start = v-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a3f5ce11ca55c13416b6ca41023636ffe">GetIncidentEdge</a>();
<a name="l00784"></a>00784         ee = start;
<a name="l00785"></a>00785         <span class="keywordflow">do</span> {
<a name="l00786"></a>00786             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* f = ee-&gt;GetLeftFace();
<a name="l00787"></a>00787             eee = f-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7dcce0b6fec6997092f464255c07c94c">GetFirstEdge</a>();
<a name="l00788"></a>00788             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; f-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3244b4e26ce13909b14aabbf66965fa">GetNumVertices</a>(); ++j) {
<a name="l00789"></a>00789                 eee-&gt;GetOrgVertex()-&gt;IncrementUsage();
<a name="l00790"></a>00790                 eee = eee-&gt;GetNext();
<a name="l00791"></a>00791             }
<a name="l00792"></a>00792             ee = v-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#ad6b5fc957ce1f0f67c25a0b66b7e86d2">GetNextEdge</a>(ee);
<a name="l00793"></a>00793             <span class="keywordflow">if</span> (ee == start) <span class="keywordflow">break</span>;
<a name="l00794"></a>00794         } <span class="keywordflow">while</span> (ee);
<a name="l00795"></a>00795         e = e-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ab9bb82e0abcc7daaa8afffe46c9c5592">GetNext</a>();
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00800"></a>00800 <span class="keywordtype">void</span>
<a name="l00801"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac9502286b77377e6664e7621fe9b4dbb">00801</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ac9502286b77377e6664e7621fe9b4dbb">HbrFace&lt;T&gt;::ClearUsage</a>() {
<a name="l00802"></a>00802     <span class="keywordtype">bool</span> gc = <span class="keyword">false</span>;
<a name="l00803"></a>00803 
<a name="l00804"></a>00804     <span class="comment">// Must mark all vertices which may affect this face</span>
<a name="l00805"></a>00805     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* v, *vv;
<a name="l00806"></a>00806     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* e = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7dcce0b6fec6997092f464255c07c94c">GetFirstEdge</a>(), *ee, *eee, *start;
<a name="l00807"></a>00807     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>; ++i) {
<a name="l00808"></a>00808         v = e-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ac78adb75925d2e2cc89260ac72cb177e">GetOrgVertex</a>();
<a name="l00809"></a>00809         start = v-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a3f5ce11ca55c13416b6ca41023636ffe">GetIncidentEdge</a>();
<a name="l00810"></a>00810         ee = start;
<a name="l00811"></a>00811         <span class="keywordflow">do</span> {
<a name="l00812"></a>00812             <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a>* f = ee-&gt;GetLeftFace();
<a name="l00813"></a>00813             eee = f-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a7dcce0b6fec6997092f464255c07c94c">GetFirstEdge</a>();
<a name="l00814"></a>00814             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; f-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ad3244b4e26ce13909b14aabbf66965fa">GetNumVertices</a>(); ++j) {
<a name="l00815"></a>00815                 vv = eee-&gt;GetOrgVertex();
<a name="l00816"></a>00816                 vv-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a61c5e7eb3364913d21c764f79150186f">DecrementUsage</a>();
<a name="l00817"></a>00817                 <span class="keywordflow">if</span> (!vv-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a089ba5cef72cb2ba9b84801c8d2512e2">IsUsed</a>()) {
<a name="l00818"></a>00818                     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;AddGarbageCollectableVertex(vv);
<a name="l00819"></a>00819                     gc = <span class="keyword">true</span>;
<a name="l00820"></a>00820                 }
<a name="l00821"></a>00821                 eee = eee-&gt;GetNext();
<a name="l00822"></a>00822             }
<a name="l00823"></a>00823             ee = v-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#ad6b5fc957ce1f0f67c25a0b66b7e86d2">GetNextEdge</a>(ee);
<a name="l00824"></a>00824             <span class="keywordflow">if</span> (ee == start) <span class="keywordflow">break</span>;
<a name="l00825"></a>00825         } <span class="keywordflow">while</span> (ee);
<a name="l00826"></a>00826         e = e-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ab9bb82e0abcc7daaa8afffe46c9c5592">GetNext</a>();
<a name="l00827"></a>00827     }
<a name="l00828"></a>00828     <span class="keywordflow">if</span> (gc) <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4659875645321a0f13dac88775d3a12d">mesh</a>-&gt;GarbageCollect();
<a name="l00829"></a>00829 }
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00832"></a>00832 <span class="keywordtype">bool</span>
<a name="l00833"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a50c9d38e11e0ccc24b5756e1f569f2f3">00833</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a50c9d38e11e0ccc24b5756e1f569f2f3">HbrFace&lt;T&gt;::GarbageCollectable</a>()<span class="keyword"> const </span>{
<a name="l00834"></a>00834     <span class="keywordflow">if</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a947b19c44fa234e0e9359050c593239c">children</a>.children || <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#aca499f5fb2e2da4985ef7465c69e5149">protect</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00835"></a>00835     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a24f02c2592019421076b47f80a8038ff">nvertices</a>; ++i) {
<a name="l00836"></a>00836         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* edge = <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a9f6839f559ed1a93a1ea9aa5749c753c">GetEdge</a>(i);
<a name="l00837"></a>00837         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html">HbrVertex&lt;T&gt;</a>* vertex = edge-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ac78adb75925d2e2cc89260ac72cb177e">GetOrgVertex</a>();
<a name="l00838"></a>00838         <span class="keywordflow">if</span> (vertex-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a089ba5cef72cb2ba9b84801c8d2512e2">IsUsed</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00839"></a>00839         <span class="keywordflow">if</span> (!<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a4d66d2d37a686c62c203fd7694c61b20">GetParent</a>() &amp;&amp; vertex-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrVertex.html#a4597a9d2af2b679672c8274b52079b59">EdgeRemovalWillMakeSingular</a>(edge)) {
<a name="l00840"></a>00840             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00841"></a>00841         }
<a name="l00842"></a>00842     }
<a name="l00843"></a>00843     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00844"></a>00844 }
<a name="l00845"></a>00845 
<a name="l00846"></a>00846 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00847"></a>00847 <span class="keywordtype">void</span>
<a name="l00848"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae4dddd0449dd335bdb8c5d3fb5d21f28">00848</a> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#ae4dddd0449dd335bdb8c5d3fb5d21f28">HbrFace&lt;T&gt;::SetHierarchicalEdits</a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHierarchicalEdit.html">HbrHierarchicalEdit&lt;T&gt;</a>** _edits) {
<a name="l00849"></a>00849     <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html#a206d687376bd6a2a45f5f209ab1ee9ac">edits</a> = _edits;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851     <span class="comment">// Walk the list of edits and look for any which apply locally.</span>
<a name="l00852"></a>00852     <span class="keywordflow">while</span> (<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHierarchicalEdit.html">HbrHierarchicalEdit&lt;T&gt;</a>* edit = *_edits) {
<a name="l00853"></a>00853         <span class="keywordflow">if</span> (!edit-&gt;IsRelevantToFace(<span class="keyword">this</span>)) <span class="keywordflow">break</span>;
<a name="l00854"></a>00854         edit-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHierarchicalEdit.html#a2d82bbbb09cd0ac3d61b70a0afd5b4b0">ApplyEditToFace</a>(<span class="keyword">this</span>);
<a name="l00855"></a>00855         _edits++;
<a name="l00856"></a>00856     }
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00860"></a><a class="code" href="namespaceOpenSubdiv_1_1OPENSUBDIV__VERSION.html#a3fa3f16cfbc426976f43bdefb7364ada">00860</a> std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const HbrFace&lt;T&gt;&amp; face) {
<a name="l00861"></a>00861     out &lt;&lt; <span class="stringliteral">&quot;face &quot;</span> &lt;&lt; face.GetID() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; face.GetNumVertices() &lt;&lt; <span class="stringliteral">&quot; vertices (&quot;</span>;
<a name="l00862"></a>00862     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; face.GetNumVertices(); ++i) {
<a name="l00863"></a>00863         <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html">HbrHalfedge&lt;T&gt;</a>* e = face.GetEdge(i);
<a name="l00864"></a>00864         out &lt;&lt; *(e-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#ac78adb75925d2e2cc89260ac72cb177e">GetOrgVertex</a>());
<a name="l00865"></a>00865         <span class="keywordflow">if</span> (e-&gt;<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrHalfedge.html#a9f48becfc6b2dacd2f0db283332ab0d3">IsBoundary</a>()) {
<a name="l00866"></a>00866             out &lt;&lt; <span class="stringliteral">&quot; -/-&gt; &quot;</span>;
<a name="l00867"></a>00867         } <span class="keywordflow">else</span> {
<a name="l00868"></a>00868             out &lt;&lt; <span class="stringliteral">&quot; ---&gt; &quot;</span>;
<a name="l00869"></a>00869         }
<a name="l00870"></a>00870     }
<a name="l00871"></a>00871     out &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;
<a name="l00872"></a>00872     <span class="keywordflow">return</span> out;
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 
<a name="l00875"></a>00875 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00876"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceOperator.html">00876</a> <span class="keyword">class </span><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceOperator.html">HbrFaceOperator</a> {
<a name="l00877"></a>00877 <span class="keyword">public</span>:
<a name="l00878"></a>00878     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceOperator.html#a10678d9c65a64e10da68df9710282e8a">operator() </a>(<a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFace.html">HbrFace&lt;T&gt;</a> &amp;face) = 0;
<a name="l00879"></a><a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceOperator.html#a56f35670eaadb77de6cfc6ddcd636d7b">00879</a>     <span class="keyword">virtual</span> <a class="code" href="classOpenSubdiv_1_1OPENSUBDIV__VERSION_1_1HbrFaceOperator.html#a56f35670eaadb77de6cfc6ddcd636d7b">~HbrFaceOperator</a>() {}
<a name="l00880"></a>00880 };
<a name="l00881"></a>00881 
<a name="l00882"></a>00882 } <span class="comment">// end namespace OPENSUBDIV_VERSION</span>
<a name="l00883"></a>00883 <span class="keyword">using namespace </span><a class="code" href="version_8h.html#a3e1fd5f7ca528466eeb21b73b1b33a8c">OPENSUBDIV_VERSION</a>;
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 } <span class="comment">// end namespace OpenSubdiv</span>
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 <span class="preprocessor">#endif </span><span class="comment">/* HBRFACE_H */</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 5 Sep 2012 for OpenSubdiv by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
